## –û—Å–Ω–æ–≤—ã Java –∏ JVM
### üìå –ß—Ç–æ —Ç–∞–∫–æ–µ Java –∏ –∫–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –µ—ë –∫–æ–¥

- Java ‚Äî —ç—Ç–æ —è–∑—ã–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è, –≤ –∫–æ—Ç–æ—Ä–æ–º –∫–æ–¥ –Ω–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –Ω–∞–ø—Ä—è–º—É—é –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–æ–º, –∫–∞–∫ –≤ C++.
- –¢—ã –ø–∏—à–µ—à—å .java —Ñ–∞–π–ª—ã, –æ–Ω–∏ –∫–æ–º–ø–∏–ª–∏—Ä—É—é—Ç—Å—è –≤ .class —Ñ–∞–π–ª—ã —Å –±–∞–π—Ç-–∫–æ–¥–æ–º.
- –≠—Ç–∏ .class —Ñ–∞–π–ª—ã —É–ø–∞–∫–æ–≤—ã–≤–∞—é—Ç—Å—è –≤ .jar (Java ARchive) ‚Äî –∞–Ω–∞–ª–æ–≥ –∞—Ä—Ö–∏–≤–∞ .zip.

### ‚öôÔ∏è –ö–∞–∫ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è Java-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
- –ß—Ç–æ–±—ã –∑–∞–ø—É—Å—Ç–∏—Ç—å .jar, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Java Virtual Machine (JVM).
- –ö–æ–º–∞–Ω–¥–∞ –∑–∞–ø—É—Å–∫–∞ –≤—ã–≥–ª—è–¥–∏—Ç —Ç–∞–∫:
```
java -jar myapp.jar
```
- JVM –±–µ—Ä—ë—Ç –±–∞–π—Ç-–∫–æ–¥ –∏ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ—Ç –µ–≥–æ, –∏–ª–∏ —Å –ø–æ–º–æ—â—å—é JIT-–∫–æ–º–ø–∏–ª—è—Ü–∏–∏ –æ–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ—Ç –µ–≥–æ –≤ –º–∞—à–∏–Ω–Ω—ã–π –∫–æ–¥ –Ω–∞ –ª–µ—Ç—É.

## üí° JVM –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
–ö–æ–≥–¥–∞ —Ç—ã –∑–∞–ø—É—Å–∫–∞–µ—à—å Java-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, —Ç—ã –º–æ–∂–µ—à—å —É–ø—Ä–∞–≤–ª—è—Ç—å –ø–æ–≤–µ–¥–µ–Ω–∏–µ–º JVM —Å –ø–æ–º–æ—â—å—é —Ñ–ª–∞–≥–æ–≤:


### –ü–∞—Ä–∞–º–µ—Ç—Ä:	–ß—Ç–æ –¥–µ–ª–∞–µ—Ç
- Xmx2G	–û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –∫—É—á–∏ (heap) –¥–æ 2–ì–±.
- Xms512M	–°—Ç–∞—Ä—Ç–æ–≤—ã–π —Ä–∞–∑–º–µ—Ä –∫—É—á–∏ ‚Äî Java –≤—ã–¥–µ–ª–∏—Ç 512–ú–± –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ.
- XX:+UseG1GC	–í–∫–ª—é—á–∞–µ—Ç —Å–±–æ—Ä—â–∏–∫ –º—É—Å–æ—Ä–∞ G1 Garbage Collector.
  
### –ö–æ–º–∞–Ω–¥–∞ –∑–∞–ø—É—Å–∫–∞ —Å–æ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º, –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–º –∏ –≤—ã–±–æ—Ä–æ–º –∫–æ–ª–ª–µ–∫—Ç–æ—Ä–∞: 
```
java -Xms1G -Xmx2G -XX:+UseG1GC -jar app.jar
```

## üì¶ –ß—Ç–æ —Ç–∞–∫–æ–µ Heap (–∫—É—á–∞) –≤ Java

–ö–æ–≥–¥–∞ Java-–ø—Ä–æ–≥—Ä–∞–º–º–∞ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è, JVM –≤—ã–¥–µ–ª—è–µ—Ç –æ–±–ª–∞—Å—Ç—å –ø–∞–º—è—Ç–∏, –∫–æ—Ç–æ—Ä–∞—è –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è Heap.
–≠—Ç–æ –º–µ—Å—Ç–æ, –≥–¥–µ –∂–∏–≤—É—Ç –≤—Å–µ —Å–æ–∑–¥–∞–Ω–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã, –ø–æ–∫–∞ –æ–Ω–∏ –Ω—É–∂–Ω—ã.

üí° –ö—Ä–∞—Ç–∫–æ:

Heap ‚Äî –æ—Å–Ω–æ–≤–Ω–æ–π —É—á–∞—Å—Ç–æ–∫ –ø–∞–º—è—Ç–∏ –¥–ª—è –æ–±—ä–µ–∫—Ç–æ–≤.
–°–æ—Å—Ç–æ–∏—Ç –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —á–∞—Å—Ç–µ–π:

| –†–∞–∑–¥–µ–ª | 	–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | 
|:-|:-:|
| Young Generation	| –ó–¥–µ—Å—å –ø–æ—è–≤–ª—è—é—Ç—Å—è –Ω–æ–≤—ã–µ –æ–±—ä–µ–∫—Ç—ã. –ß–∞—Å—Ç–æ –æ—á–∏—â–∞–µ—Ç—Å—è.|
| Old Generation	| –û–±—ä–µ–∫—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ "–≤—ã–∂–∏–ª–∏" –¥–æ–ª–≥–æ, –ø–µ—Ä–µ–µ–∑–∂–∞—é—Ç —Å—é–¥–∞.|
| Metaspace	| –•—Ä–∞–Ω–∏—Ç –º–µ—Ç–∞–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∫–ª–∞—Å—Å–æ–≤ (—Å 8-–π Java –≤–º–µ—Å—Ç–æ PermGen). |

### üí° –ö–∞–∫ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Ä–∞–±–æ—Ç–∞:
1. –¢—ã —Å–æ–∑–¥–∞—ë—à—å –æ–±—ä–µ–∫—Ç.
2. –û–Ω –ª–æ–∂–∏—Ç—Å—è –≤ Young Generation.
3. –ï—Å–ª–∏ –æ–Ω "–≤—ã–∂–∏–≤–∞–µ—Ç" –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–±–æ—Ä–æ–∫ –º—É—Å–æ—Ä–∞ ‚Äî –ø–µ—Ä–µ–µ–∑–∂–∞–µ—Ç –≤ Old Generation.
4. –ï—Å–ª–∏ –ø–∞–º—è—Ç—å –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è, GC –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.

### –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ø–∞–º—è—Ç—å Java:
1. ps aux | grep java - –ù–∞—Ö–æ–¥–∏–º PID.
2. jcmd 1234 GC.heap_info –°–º–æ—Ç—Ä–∏–º –ø–æ —ç—Ç–æ–º—É PID —Ç–æ—á–µ—á–Ω–æ.
3. Heap:
 garbage-first heap   total 512M, used 128M.
–†—É–∑–ª—å—Ç–∞—Ç –∫–æ—Ç–æ—Ä—ã–π –º—ã –ø–æ–ª—É—á–∏–ª–∏.

### jstat ‚Äî –±—ã—Å—Ç—Ä–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–∞–º—è—Ç–∏
```
jstat -gc 1234 1000 5
```
–≠—Ç–∞ –∫–æ–º–∞–Ω–¥–∞ –∫–∞–∂–¥—ã–µ —Å–µ–∫—É–Ω–¥—É –ø–æ–∫–∞–∂–µ—Ç –ø–∞–º—è—Ç—å –∏ GC-–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å 5 —Ä–∞–∑:


| –†–∞–∑–¥–µ–ª | 	–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | 
|:-|:-:|
|S0C, S1C| 	–†–∞–∑–º–µ—Ä survivor-–ø–∞–º—è—Ç–∏ –≤ Young Gen.|
|EC	|Eden-–ø–∞–º—è—Ç—å.|
|OC	Old |Generation. |
|MC, CCSC	|Metaspace –∏ Compressed Class Space. |
|YGC / YGCT	|–°–∫–æ–ª—å–∫–æ —Ä–∞–∑ GC —á–∏—Å—Ç–∏–ª –º–æ–ª–æ–¥—É—é –ø–∞–º—è—Ç—å –∏ —Å–∫–æ–ª—å–∫–æ –≤—Ä–µ–º–µ–Ω–∏ –ø–æ—Ç—Ä–∞—Ç–∏–ª. |
| vFGC / FGCT	|–ü–æ–ª–Ω–∞—è —Å–±–æ—Ä–∫–∞ –º—É—Å–æ—Ä–∞ –∏ –µ—ë –≤—Ä–µ–º—è.| 


### –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞:
```
 S0C    S1C    EC      OC      YGC   FGC    FGCT
1024.0 1024.0 8192.0  4096.0  12    2      0.110

```
### –ì–¥–µ:
- YGC = 12 ‚Äî –∑–∞ –≤—Ä–µ–º—è –∂–∏–∑–Ω–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞ –º–æ–ª–æ–¥–∞—è –ø–∞–º—è—Ç—å —Å–æ–±–∏—Ä–∞–ª–∞—Å—å 12 —Ä–∞–∑.
- FGC = 2 ‚Äî 2 –ø–æ–ª–Ω—ã—Ö —Å–±–æ—Ä–∫–∏ –º—É—Å–æ—Ä–∞.
- FGCT = 0.110 ‚Äî —Å—É–º–º–∞—Ä–Ω–æ–µ –≤—Ä–µ–º—è —Å–±–æ—Ä–æ–∫: 0.11 —Å–µ–∫.


